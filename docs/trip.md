# 人狼Onlineのトリップについて

## トリップとは
Wikioediaによると
:::info
トリップとは、個人の識別のために使われる文字列を表示する機能、またはその機能によって表示された文字列を指す。
:::

<img src="/images/image1.webp" width="600" style="display: block; margin: auto;">

プレイヤー名をタップすると表示されるこれですね。

人狼Onlineではアカウントを作成することなく自由にゲームに参加することができます。また、すでに他の人に利用されている名前も使うことができます。そのため、他のプレイヤーの名前を使って荒らしなどを行う人が出た場合、本人と見分けることが困難になってしまいます。

そのような、**なりすましを防ぐために使われるものがトリップ**です。

## トリップの付け方
<img src="/images/image2.webp" width="500" style="display: block; margin: auto;">

このように、プレイヤー名の後に#をつけて任意の半角英数字10文字を入力すると下のように**固定トリップ**を付けることができます。

<img src="/images/image3.webp" width="600" style="display: block; margin: auto;">

固定トリップには◆がつきます。また、固定トリップ（固定酉）に対して◆のついていないトリップは素トリップ（素酉）と呼ばれます。

このときに入力した #**********（任意の半角英数字10文字）を**トリップキー**と呼びます。（#は半角です。全角＃と間違えやすいので注意。）

トリップは入力されるトリップキーによって決まります。#Tarabaganiと入力すれば、必ず◆yClz510H9lとなります。トリップキーとトリップの関係は不規則です。トリップキーを1文字でも変えると、全く別のトリップができます。（ただしトリップキーとして使われるのは8文字目までなので、9文字目と10文字目は関係なく、トリップに影響はしません）

トリップは、トリップキーをトリップに変換することはできても、トリップをトリップキーに変換することはできないようにできています。

○　#Tarabagani　→　◆yClz510H9l

✕　◆yClz510H9l　→　#Tarabagani

つまり、**トリップキーは本人しか知らないため、トリップがその人は本人であるという証明になります。**

## なぜ固定トリップをつけるのか
ここまでの説明を読んで、

「別にトリップを固定せずとも素トリップで判別すれば良いのでは？」

と思った方もいると思います。

固定トリップには、端末を変えても同じトリップを使うことができるという利点の他に、信頼性が高いという利点があります。

素トリップは信頼性が低いの？と問われると、残念ながら低いです。なぜなら素トリップは改竄することができるからです。

<img src="/images/image14.png" width="600" style="display: block; margin: auto;">
<img src="/images/image15.png" width="600" style="display: block; margin: auto;">

このように、実は自由に設定できます。トラブルの原因になるのであまり広まっていませんが、要するに**素トリップは安全ではない**ということです。

## 10桁トリップと12桁トリップ

トリップキーをつけるのに半角英数字10文字を入力すると述べましたが、それに加えて .（ピリオド）と /（スラッシュ）も使えます。

正確にはUTF-8の10byteの文字列が使えます。（UTF-8は文字コードの1種です。ここでの説明は省略します。）

10byte以外の文字列をトリップキーにした場合、10桁トリップは付きません。

人狼Onlineには10桁トリップの他に、12桁トリップがあります。

12桁トリップはUTF-8の12byte以上の文字列をトリップキーにした場合に付けることができます。

<img src="/images/image4.png" width="500" style="display: block; margin: auto;">
<br>
<img src="/images/image5.png" width="600" style="display: block; margin: auto;">

ざっくり言うと、**#の後に半角英数字10文字を入れると10桁トリップ、半角英数字12文字を入れると12桁トリップを付けることができます。**

## トリップ検索とは

トリップの文字列はトリップキーによって不規則に決まると述べましたが、ある程度なら任意の文字列を入れることができます。

一体どうやるのか。

トリップからトリップキーをつくれないのなら方法は1つ。それは総当りです。

つまりトリップキーを適当に入れまくって自分の望むトリップができるまで続けるんですね。

最初の1桁や2桁はそれでできるかもしれませんが、あまり現実的ではないので実際にはプログラムにやらせます。

ブラウザでトリップを検索するには[トリップ検索サイト](https://olivier-zinro.fc2.net/blog-category-21.html)や[UTF](https://milkybot.wiki.fc2.com/wiki/UncoTripFinder)、[12桁トリップメーカー](/12trip/)などのサイトがあります。

また、PC向けに[Meriken's Tripcode Engine](https://github.com/meriken/merikens-tripcode-engine-v3)という高速なトリップ検索ソフトがあります。パソコンを持っている人はこちらを使うのがいいかと思います。

## トリップ検索にかかる時間

一致させる文字数を増やすごとに指数関数的に増加します。3文字トリップは比較的かんたんに作れますが、5文字トリップになるとブラウザ検索では厳しくなります。パソコンでトリップ検索ソフトを使っても、8文字以上一致させるには時間がかかります。

この **「検索に時間がかかる」ことが固定トリップの安全性を高めています。**

トリップ検索ツールで他人と全く同じトリップを作ろうとした場合、完成させるには膨大な時間がかかるため現実的ではありません。

## トリップ検索にかかる時間の目安(UTFを使用した場合)

### ブラウザ版

ブラウザで検索する場合はパソコンとモバイル端末ではそんなに差がないかなという印象です。もちろんスペックに依存するのですが、

|端末|計算速度|
|:-:|:-:|
|iPhone SE（初代)|3000Trips/sec|
|iPhone12|11000Trips/sec|
|パソコン（Ryzen7 5800H）| 12000Trips/sec|

ぐらいのスピードで計算できます。パソコンはタブ数を増せばさらに計算速度は上がります。以下に12000Trip/secで計算した場合の所要時間を示します。

3文字トリップ　　22秒
<br>4文字トリップ　　23分
<br>5文字トリップ　　1491分

この所要時間は推定ですので、運が良ければ1秒で出る可能性も0ではありません。

サイコロでイメージすると分かりやすいです。例えば6という目を出そうとすると、1回目の試行で出る確率は6分の1ですが、3回目では2分の1になります。

トリップに当てはめて考えると、5文字トリップを作ろうとした場合はすべてのパターンが 64の5乗=1073741824となります。

つまり1073741824面のサイコロ（ほぼ球体ですが…）の中から特定の1パターンを出すようなものです。計算速度は1秒間にサイコロを振る回数です。

上の例に当てはめると、1秒間に12000回サイコロを振るということなので、

1073741824÷12000=89479秒（1491分）

すべてのパターンを出す目安は1491分となります。目安なので、1491分よりも早く終わる時もあれば、さらに時間がかかる時もあります。

ブラウザでの話をしましたが、パソコンではどうなのかというとトリップ検索ソフトを使った場合の検索速度は

10桁で　　130000000Trips/sec
<br>12桁で　　300000000Trips/sec

ほどの速度が出ます。私の環境での速度なので、さらに高性能なCPUを使った場合はもっと速度が出ると思います。Meriken's Tripcode EngineはGPUを使って計算することもできるようなので、ゲーミングパソコンを持ってる方は試してみると良いかもしれません。（私は普通のノートパソコンを使っているので検証できませんでした。）

やはり検索ソフトは高速ですね。ブラウザの1万倍くらいの速度が出ています。5文字トリップがおよそ8秒でできてしまう速度です。

（ブラウザ版では10桁トリップについてしか書いていませんが、これは12桁トリップを検索できるサイトを私が知らないためです。もしかしたら12桁トリップ検索サイトがあるかもしれないです。）

## 個人的な考え
5文字トリップ以上を検索するならパソコンを使わないと厳しい印象。スマホでブラウザの検索ツールを使う場合、画面を表示し続ける必要があるので不便だと感じました。とはいえ4文字以下なら普通に検索できるので、有効な検索手段だとは思います。

## 参考文献
[トリップ - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%AA%E3%83%83%E3%83%97_(%E9%9B%BB%E5%AD%90%E6%8E%B2%E7%A4%BA%E6%9D%BF))

[トリップについて - Qiita](https://qiita.com/KiwamiTrip/items/863baf9e82064603c22d)

[トリップの安全性 - Milkyの裏人狼onlinewiki](https://milkybot.wiki.fc2.com/wiki/%E3%83%88%E3%83%AA%E3%83%83%E3%83%97%E3%81%AE%E5%AE%89%E5%85%A8%E6%80%A7)

---
### おまけ

ご自由にどうぞ

◆Logical.EYZR　　#AｴF､c給ｭ｢｡ﾕﾋ
